name: Auto Merge

on:
  workflow_run:
    workflows:
      - 'PR Validation'
      - 'Security & Performance'
      - 'Dependency Review'
      - 'Docker Validation'
    types: [completed]

jobs:
  auto-merge:
    name: Auto Merge
    if: github.event.workflow_run.conclusion == 'success'
    uses: Philippe-arnd/reusable-workflow-vibecoded/.github/workflows/reusable-auto-merge.yml@main
    with:
      required-checks: |
        PR Validation / âœ… Quick Checks
        PR Validation / ğŸ§ª Vitest Tests
        PR Validation / ğŸ”’ RLS Tests
        Security & Performance / ğŸ”‘ Secret Detection
        Security & Performance / ğŸ›¡ï¸ Security Scan
        Dependency Review / ğŸ” Review Dependencies for Vulnerabilities
      merge-method: 'squash'
      base-branch: 'main'
      block-label: 'major-update'
    permissions:
      contents: write
      pull-requests: write
      checks: read
